{
  "summary": {
    "title": "Door Threat Model",
    "owner": "Jared Garalde",
    "description": "The IoTurity Smart Door is the first product offering of the IoTurity Product Suite. This Smart Front Door is the perfect solution for your home or office. It responds to standard emergency response codes, allows you to define the hours of operation, and is built with security in mind, requiring any remote requests to lock or unlock are authenticated."
  },
  "detail": {
    "contributors": [
      {
        "name": "Bob Yang"
      },
      {
        "name": "Aki Shibuya"
      },
      {
        "name": "Zach Siron"
      },
      {
        "name": "Annie Ng"
      }
    ],
    "diagrams": [
      {
        "title": "STRIDE",
        "thumbnail": "./public/content/images/thumbnail.jpg",
        "id": 0,
        "diagramJson": {
          "cells": [
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 446,
                "y": 136
              },
              "angle": 0,
              "id": "3ee0ba67-c046-4ada-83aa-5a864d1e2e8a",
              "z": 4,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "title": "Publisher client identifiers not randomized in MQTT broker"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "Publisher Client"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 88,
                "y": 327
              },
              "angle": 0,
              "id": "721901a6-e45f-4fec-a37e-532e53874fea",
              "z": 17,
              "hasOpenThreats": false,
              "storesCredentials": true,
              "isALog": true,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Client Local Storage"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "24b45371-c69d-43ab-929a-86b64d6360bc"
              },
              "target": {
                "id": "3ee0ba67-c046-4ada-83aa-5a864d1e2e8a"
              },
              "vertices": [
                {
                  "x": 422,
                  "y": 365
                }
              ],
              "id": "60bdaaa9-145b-48d9-843a-598751abf3be",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "State Change",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 26,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "State change is in plaintext",
                  "type": "Information disclosure"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "State change logic in plaintext",
                  "type": "Tampering"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 139,
                "y": 513
              },
              "angle": 0,
              "id": "24b45371-c69d-43ab-929a-86b64d6360bc",
              "z": 27,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Boolean logic is by string matching",
                  "type": "Spoofing",
                  "description": "Threat actors can send topics to satisfy boolean logic in door check",
                  "mitigation": "Use numbers or stored procedures etc."
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "State Change\nCheck"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "3ee0ba67-c046-4ada-83aa-5a864d1e2e8a"
              },
              "target": {
                "id": "24b45371-c69d-43ab-929a-86b64d6360bc"
              },
              "vertices": [
                {
                  "x": 373,
                  "y": 324
                }
              ],
              "id": "c49e5c05-a44d-40f8-a738-a2afa9eadbdf",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Topic Status",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 28,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Status is sent in plaintext",
                  "type": "Tampering"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "24b45371-c69d-43ab-929a-86b64d6360bc"
              },
              "target": {
                "id": "721901a6-e45f-4fec-a37e-532e53874fea"
              },
              "vertices": [],
              "id": "e3043cc1-72df-40db-b1b8-4d1fcef09461",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "State Change Status",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 35,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Actor",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 1182,
                "y": 77
              },
              "angle": 0,
              "id": "90071eeb-eb92-40f7-819f-ce5c823e8d33",
              "z": 40,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "title": "Tainted requests can modify client",
                  "description": ""
                },
                {
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of privilege",
                  "title": "Lateral movement through client network"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Tainted topics can disclose information",
                  "type": "Information disclosure"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "DDoS with subscription updates",
                  "type": "Denial of service"
                }
              ],
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "Subscriber Client"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "5b357c26-cad9-4c51-ab80-9d62a892b70a"
              },
              "target": {
                "id": "90071eeb-eb92-40f7-819f-ce5c823e8d33"
              },
              "vertices": [
                {
                  "x": 1025,
                  "y": 99
                }
              ],
              "id": "ab2e89eb-c659-451c-9852-c31c4433f6c6",
              "labels": [
                {
                  "position": {
                    "distance": 0.4378598582555707,
                    "offset": 0.35598891782309305
                  },
                  "attrs": {
                    "text": {
                      "text": "Publish",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 43,
              "hasOpenThreats": true,
              "protocol": "MQTT",
              "isPublicNetwork": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "See #P01",
                  "type": "Tampering"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "90071eeb-eb92-40f7-819f-ce5c823e8d33"
              },
              "target": {
                "id": "5b357c26-cad9-4c51-ab80-9d62a892b70a"
              },
              "vertices": [
                {
                  "x": 1001,
                  "y": 157
                }
              ],
              "id": "75a9881a-5b34-4e6f-9bdb-be372ff84a57",
              "labels": [
                {
                  "position": {
                    "distance": 0.4653098042268955,
                    "offset": 2.1765928726617085
                  },
                  "attrs": {
                    "text": {
                      "text": "Subscribe",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 44,
              "hasOpenThreats": true,
              "protocol": "MQTT",
              "isPublicNetwork": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Any user can subscribe to topics",
                  "type": "Elevation of privilege",
                  "description": "Any normal user can subscribe to topics"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "3ee0ba67-c046-4ada-83aa-5a864d1e2e8a"
              },
              "target": {
                "id": "5b357c26-cad9-4c51-ab80-9d62a892b70a"
              },
              "vertices": [
                {
                  "x": 662,
                  "y": 175
                }
              ],
              "id": "7de6ce44-c228-4607-924b-c157f4ea276a",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Publish",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 45,
              "hasOpenThreats": true,
              "protocol": "MQTT",
              "isPublicNetwork": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Any user can publish topics #P01",
                  "type": "Tampering",
                  "description": "Any normal user can publish topics to MQTT broker. Can make changes to topics that smart device uses to perform logic.",
                  "mitigation": "Enforce authorization controls such as role-based access or user logins."
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Any user can publish topics #P02",
                  "type": "Elevation of privilege",
                  "description": "No privileges or roles defined for publishing topics",
                  "mitigation": "Establish roles with clear privileges for publishing"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "title": "Any user can publish topics #P03",
                  "description": "No authorization controls so users can make changes without any way to differentiate"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "title": "Over public network"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "No network encryption",
                  "type": "Information disclosure"
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Process",
              "size": {
                "width": 100,
                "height": 100
              },
              "position": {
                "x": 810,
                "y": 123
              },
              "angle": 0,
              "id": "5b357c26-cad9-4c51-ab80-9d62a892b70a",
              "z": 46,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "No limit on amount of requests",
                  "type": "Denial of service",
                  "description": "Many publish or subscribe requests can use up all memory or network bandwidth so clients can connect.",
                  "mitigation": "Enforce publish/subscribe limit per client, overall request limits"
                },
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "No check for secure and trustworthy connections to MQTT Broker",
                  "type": "Spoofing"
                }
              ],
              "privilegeLevel": "None",
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "MQTT Broker"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "721901a6-e45f-4fec-a37e-532e53874fea"
              },
              "target": {
                "id": "3ee0ba67-c046-4ada-83aa-5a864d1e2e8a"
              },
              "vertices": [
                {
                  "x": 325,
                  "y": 243
                }
              ],
              "id": "88a6d13e-4ea5-47a1-88c7-ec49ace1de5d",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Config",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 47,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 385,
                "y": 270
              },
              "target": {
                "x": 565,
                "y": 300
              },
              "vertices": [],
              "id": "b41bc655-7084-478f-a222-55c3877fae73",
              "z": 48,
              "attrs": {}
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "721901a6-e45f-4fec-a37e-532e53874fea"
              },
              "target": {
                "id": "b58b8a2f-bb81-4ad6-b8d0-73ea854e97ec"
              },
              "vertices": [
                {
                  "x": 213,
                  "y": 179
                }
              ],
              "id": "dbb4be51-acd3-4407-bf94-367026bbe83d",
              "labels": [
                {
                  "position": {
                    "distance": 0.4815847088597917,
                    "offset": 13.974141466789424
                  },
                  "attrs": {
                    "text": {
                      "text": "Push Code Changes",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 51,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "Medium",
                  "title": "Modifiable code credentials and logic",
                  "type": "Tampering",
                  "description": "Threat actors can change code credentials such as the door codes and logic for topic checks. For example, you can change the required times that the door can be unlocked.",
                  "mitigation": "Enforce permissions proper authorization for code changes. Do not let remote actors without any privileges to make changes to code."
                }
              ],
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Flow",
              "smooth": true,
              "source": {
                "id": "b58b8a2f-bb81-4ad6-b8d0-73ea854e97ec"
              },
              "target": {
                "id": "721901a6-e45f-4fec-a37e-532e53874fea"
              },
              "vertices": [
                {
                  "x": 70,
                  "y": 197
                }
              ],
              "id": "d25e115d-30c9-478c-bc86-45784ffed935",
              "labels": [
                {
                  "position": 0.5,
                  "attrs": {
                    "text": {
                      "text": "Pull Code Changes",
                      "font-weight": "400",
                      "font-size": "small"
                    }
                  }
                }
              ],
              "z": 52,
              "hasOpenThreats": false,
              "attrs": {
                ".marker-target": {
                  "class": "marker-target hasNoOpenThreats isInScope"
                },
                ".connection": {
                  "class": "connection hasNoOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 68,
                "y": 12
              },
              "angle": 0,
              "id": "b58b8a2f-bb81-4ad6-b8d0-73ea854e97ec",
              "z": 53,
              "hasOpenThreats": true,
              "threats": [
                {
                  "status": "Open",
                  "severity": "High",
                  "title": "Publicly Viewable Codebase",
                  "type": "Information disclosure",
                  "description": "The operation and logic that the smart device uses are viewable to the public in plaintext. Provides valuable information for potential attack vectors.",
                  "mitigation": "Make repository private. Enforce proper authentication and role-based access. Possibly encrypt at rest to preserve confidentiality."
                }
              ],
              "storesCredentials": true,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasOpenThreats isInScope"
                },
                "text": {
                  "text": "GitHub Repository"
                },
                ".element-text": {
                  "class": "element-text hasOpenThreats isInScope"
                }
              }
            },
            {
              "type": "tm.Boundary",
              "smooth": true,
              "source": {
                "x": 52,
                "y": 142
              },
              "target": {
                "x": 245,
                "y": 135
              },
              "vertices": [
                {
                  "x": 155,
                  "y": 147
                }
              ],
              "id": "bae6964e-6334-4575-a8b7-841d02bd6274",
              "z": 54,
              "attrs": {}
            },
            {
              "type": "tm.Store",
              "size": {
                "width": 160,
                "height": 80
              },
              "position": {
                "x": 1182,
                "y": 198
              },
              "angle": 0,
              "id": "00da4d3f-c607-45c9-b58b-78b728e64313",
              "z": 55,
              "hasOpenThreats": false,
              "attrs": {
                ".element-shape": {
                  "class": "element-shape hasNoOpenThreats isInScope"
                },
                "text": {
                  "text": "Subscriber Store"
                },
                ".element-text": {
                  "class": "element-text hasNoOpenThreats isInScope"
                }
              }
            }
          ]
        },
        "size": {
          "height": 863,
          "width": 1707
        }
      }
    ]
  }
}